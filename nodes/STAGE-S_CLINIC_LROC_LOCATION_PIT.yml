steps:
  S_CLINIC_LROC_LOCATION_PIT-200003014:
    operation:
      config: {}
      customOverride: false
      dependencies: []
      deployEnabled: false
      description: ""
      isMultisource: false
      locationID: 20000006
      locationName: STAGE
      materializationType: view
      metadata:
        columns:
          - columnReference:
              columnCounter: 2000014763
              stepCounter: "200003014"
            dataType: CHAR(32)
            defaultValue: ""
            description: ""
            name: HK_H_CLINIC
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014764
              stepCounter: "200003014"
            dataType: TIMESTAMP(26,6)
            defaultValue: ""
            description: ""
            name: CREATED_AT
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014765
              stepCounter: "200003014"
            dataType: TIMESTAMP(26,6)
            defaultValue: ""
            description: ""
            name: UPDATED_AT
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014766
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: CREATED_BY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014767
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: UPDATED_BY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014768
              stepCounter: "200003014"
            dataType: VARCHAR(100)
            defaultValue: ""
            description: ""
            name: PUBLIC_WEBSITE_CONTENT
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014769
              stepCounter: "200003014"
            dataType: VARCHAR(100)
            defaultValue: ""
            description: ""
            name: FLYER_CONTENT
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014770
              stepCounter: "200003014"
            dataType: VARCHAR(36)
            defaultValue: ""
            description: ""
            name: UNIQUE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014771
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014772
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014773
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: CITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014774
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: STATE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014775
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: FACILITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014776
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: PUBLIC
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014777
              stepCounter: "200003014"
            dataType: VARCHAR(5)
            defaultValue: ""
            description: ""
            name: ZIP
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014778
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: LATITUDE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014779
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: LONGITUDE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014780
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: TIME_ZONE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014781
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: MESSAGE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014782
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_ACTIVE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014783
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014784
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: WEBSITE_URL
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014785
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: LOCATION_DESCRIPTION
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014786
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_REPORTABLE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014787
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_BE_LOCATED
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014788
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: ABBREVIATION
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014789
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: EXTERNAL_FACILITY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014790
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: LIAISON_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014791
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PHONETIC_CITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014792
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PHONETIC_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014793
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PHONETIC_FACILITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014794
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: CLINIC_FREQUENCY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014795
              stepCounter: "200003014"
            dataType: DATE
            defaultValue: ""
            description: ""
            name: GOAL_START_ON
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014796
              stepCounter: "200003014"
            dataType: DATE
            defaultValue: ""
            description: ""
            name: GOAL_END_ON
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014797
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: CLINIC_GOALS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014798
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: HIDE_CREDIT_AMOUNTS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014799
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: BRAND_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014800
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: FLYER_ADVERTISEMENT_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014801
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: COUNTY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014802
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014803
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: CITY_SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014804
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: COUNTY_SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014805
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: STATE_SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014806
              stepCounter: "200003014"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: DISTRICT_SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014807
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: CITY_TAX_CODE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014808
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: COUNTY_TAX_CODE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014809
              stepCounter: "200003014"
            dataType: TIMESTAMP(26,6)
            defaultValue: ""
            description: ""
            name: TAXES_LAST_UPDATED_AT
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014810
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: HAS_SALES_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014811
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: NUMBER_OF_FLYERS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014812
              stepCounter: "200003014"
            dataType: VARCHAR(500)
            defaultValue: ""
            description: ""
            name: HOURS_OF_OPERATION
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014813
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: LANDMARK
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014814
              stepCounter: "200003014"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: TIER
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014815
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_WELLNESS_CENTER
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014816
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: PRICE_TYPE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014817
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: NET_SUITE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014818
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: DEFAULT_AD_HOC_PRESCRIPTION_PHARMACY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014819
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_SELL_NAIL_TRIMS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014821
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: ZIPCODE_RADIUS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014822
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_SELL_MICROCHIPS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014823
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: ORDER_FULFILLMENT_PHARMACY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014824
              stepCounter: "200003014"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: PROACTIVE_PRESCRIPTION_PHARMACY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014825
              stepCounter: "200003014"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_CONTRACT_IT_NOW
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014826
              stepCounter: "200003014"
            dataType: TGT_CHAR(32)
            defaultValue: ""
            description: The changing hash
            name: DSS_CHANGE_HASH
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014827
              stepCounter: "200003014"
            dataType: TGT_VARCHAR(255)
            defaultValue: ""
            description: Record source
            name: DSS_RECORD_SOURCE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014828
              stepCounter: "200003014"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row was loaded in the data vault
            name: DSS_LOAD_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014829
              stepCounter: "200003014"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row started in the data vault
            name: DSS_START_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014830
              stepCounter: "200003014"
            dataType: TGT_INTEGER
            defaultValue: ""
            description: Version number of a business key in the data vault
            name: DSS_VERSION
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014831
              stepCounter: "200003014"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row was inserted in the data vault
            name: DSS_CREATE_TIME
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2000014832
              stepCounter: "200003014"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: End date determined by the next Satellite change record dss_start_date
            name: DSS_END_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: "LEAD(DSS_START_DATE, 1, '9999-12-31') OVER (PARTITION\
                  \ BY HK_H_CLINIC                                             ORDER\
                  \ BY DSS_START_DATE)                         "
          - columnReference:
              columnCounter: 2000014833
              stepCounter: "200003014"
            dataType: TGT_VARCHAR(1)
            defaultValue: ""
            description: CurrentFlag 'N' unless next Satellite change record dss_start_date
              is null, indicating this is the most current record.
            name: DSS_CURRENT_FLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: "CASE     WHEN LEAD(DSS_START_DATE, 1, NULL) OVER(PARTITION\
                  \ BY HK_H_CLINIC                                             ORDER\
                  \ BY DSS_START_DATE) IS NULL    THEN 'Y'    ELSE 'N' END       \
                  \                  "
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies: []
            join:
              joinCondition: ''
            name: S_CLINIC_LROC_LOCATION_PIT
            noLinkRefs: []
      name: S_CLINIC_LROC_LOCATION_PIT
      overrideSQL: false
      sqlType: View
      type: sql
    stepCounter: "200003014"
