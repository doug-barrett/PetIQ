steps:
  S_PACKAGE_LROC_INFO_PIT-200003036:
    operation:
      config: {}
      customOverride: false
      dependencies: []
      deployEnabled: false
      description: ""
      isMultisource: false
      locationID: 20000006
      locationName: STAGE
      materializationType: view
      metadata:
        columns:
          - columnReference:
              columnCounter: 2000015503
              stepCounter: "200003036"
            dataType: CHAR(32)
            defaultValue: ""
            description: ""
            name: HK_H_PACKAGE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033677
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015504
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: CODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033678
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015505
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PRODUCT_ALTERNATE_DESCRIPTION
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033679
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015506
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: NICKNAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033680
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015507
              stepCounter: "200003036"
            dataType: TIMESTAMP(26,6)
            defaultValue: ""
            description: ""
            name: CREATED_AT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033681
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015508
              stepCounter: "200003036"
            dataType: TIMESTAMP(26,6)
            defaultValue: ""
            description: ""
            name: UPDATED_AT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033682
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015509
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: PRODUCT_TYPE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033683
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015510
              stepCounter: "200003036"
            dataType: NUMERIC(5,2)
            defaultValue: ""
            description: ""
            name: WEIGHT_RANGE_MINIMUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033684
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015511
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: MANUFACTURER_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033685
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015512
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: VACCERT_DISPLAY_GROUP_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033686
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015513
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_ACTIVE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033687
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015514
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_PRESCRIPTION
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033688
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015515
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: DOSAGE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033689
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015516
              stepCounter: "200003036"
            dataType: NUMERIC(28,6)
            defaultValue: ""
            description: ""
            name: CONTAINER_COUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033690
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015517
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: HISTORICAL_CODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033691
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015518
              stepCounter: "200003036"
            dataType: NUMERIC(5,2)
            defaultValue: ""
            description: ""
            name: WEIGHT_RANGE_MAXIMUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033692
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015519
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: REBATE_URL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033693
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015520
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_BE_DISPLAYED_ON_ORDER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033694
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015521
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: CREATED_BY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033695
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015522
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: UPDATED_BY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033696
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015523
              stepCounter: "200003036"
            dataType: VARCHAR(36)
            defaultValue: ""
            description: ""
            name: UNIQUE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033697
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015524
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_POINT_OF_SALE_PRODUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033698
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015525
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033699
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015526
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: UPC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033700
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015527
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: MAXIMUM_AGE_WEEKS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033701
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015528
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: REQUIRES_BARCODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033702
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015529
              stepCounter: "200003036"
            dataType: VARCHAR(20)
            defaultValue: ""
            description: ""
            name: BARCODE_PREFIX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033703
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015530
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: BARCODE_LENGTH
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033704
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015531
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: REQUIRED_INTACT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033705
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015532
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: NEEDS_VET_TO_FINISH
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033706
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015533
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: REQUIRES_LOT_NUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033707
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015534
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: SORT_ORDER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033708
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015535
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_PURCHASE_MULTIPLES
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033709
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015536
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: MINIMUM_AGE_WEEKS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033710
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015537
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_KIT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033711
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015538
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: RECEIPT_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033712
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015539
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: EXCHANGEABLE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033713
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015540
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: CAN_BE_DISPLAYED_AT_CLINICS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033714
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015541
              stepCounter: "200003036"
            dataType: FLOAT8
            defaultValue: ""
            description: ""
            name: UNIT_COST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033715
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015542
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: QUANTITY_ON_HAND
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033716
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015543
              stepCounter: "200003036"
            dataType: TEXT
            defaultValue: ""
            description: ""
            name: DOSAGE_INSTRUCTIONS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033717
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015544
              stepCounter: "200003036"
            dataType: VARCHAR(255)
            defaultValue: ""
            description: ""
            name: PRESCRIPTION_DESCRIPTION
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033718
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015545
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_AUTOSHIP
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033719
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015546
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: NET_SUITE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033720
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015547
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_SUBSCRIPTION
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033721
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015548
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_SUBSCRIBABLE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033722
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015549
              stepCounter: "200003036"
            dataType: INT4
            defaultValue: ""
            description: ""
            name: SUBSCRIPTION_COUPON_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033723
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015550
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: IS_PREFERRED
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033724
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015551
              stepCounter: "200003036"
            dataType: BOOL
            defaultValue: ""
            description: ""
            name: REQUIRES_CLINIC_TEST_RESULTS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033725
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015552
              stepCounter: "200003036"
            dataType: TGT_CHAR(32)
            defaultValue: ""
            description: The changing hash
            name: DSS_CHANGE_HASH
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033726
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015553
              stepCounter: "200003036"
            dataType: TGT_VARCHAR(255)
            defaultValue: ""
            description: Record source
            name: DSS_RECORD_SOURCE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033727
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015554
              stepCounter: "200003036"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row was loaded in the data vault
            name: DSS_LOAD_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033728
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015555
              stepCounter: "200003036"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row started in the data vault
            name: DSS_START_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033729
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015556
              stepCounter: "200003036"
            dataType: TGT_INTEGER
            defaultValue: ""
            description: Version number of a business key in the data vault
            name: DSS_VERSION
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033730
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015557
              stepCounter: "200003036"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: Date and time the row was inserted in the data vault
            name: DSS_CREATE_TIME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000033731
                    stepCounter: "200003759"
                transform: ""
          - columnReference:
              columnCounter: 2000015558
              stepCounter: "200003036"
            dataType: TGT_DATETIME
            defaultValue: ""
            description: End date determined by the next Satellite change record dss_start_date
            name: DSS_END_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: "LEAD(DSS_START_DATE, 1, '9999-12-31') OVER (PARTITION\
                  \ BY HK_H_PACKAGE                                             ORDER\
                  \ BY DSS_START_DATE)                         "
          - columnReference:
              columnCounter: 2000015559
              stepCounter: "200003036"
            dataType: TGT_VARCHAR(1)
            defaultValue: ""
            description: CurrentFlag 'N' unless next Satellite change record dss_start_date
              is null, indicating this is the most current record.
            name: DSS_CURRENT_FLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: "CASE     WHEN LEAD(DSS_START_DATE, 1, NULL) OVER(PARTITION\
                  \ BY HK_H_PACKAGE                                             ORDER\
                  \ BY DSS_START_DATE) IS NULL    THEN 'Y'    ELSE 'N' END       \
                  \                  "
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: S_PACKAGE_LROC_INFO
            join:
              joinCondition: ''
            name: S_PACKAGE_LROC_INFO_PIT
            noLinkRefs: []
      name: S_PACKAGE_LROC_INFO_PIT
      overrideSQL: false
      sqlType: View
      type: sql
    stepCounter: "200003036"
